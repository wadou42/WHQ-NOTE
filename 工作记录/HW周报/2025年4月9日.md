### 1. 关键优化标志
筛选方法：在O3的基础上关闭一条优化配置（例如 -falign-jumps）记录性能变化。如果性能变化较大，则认为是关键优化标志。

检查关键优化标志对于doris的影响， 额外的考虑一些其他的数据集。 


筛选结果：如果以百分之1为阈值，大概有**40个关键优化标志**。
**关键优化标志对doris影响**
应用：在生成随机优化序列时所有的非关键优化标志不变，只修改关键优化标志；在搜索阶段，只对关键优化标志进行变异，不对非关键优化标志进行变异，减小搜索空间。
### 2. redis、doris测试

redis 测试，每个opt重复50次取均值，搜索策略——random
![[redis测试.50repeat.png]]

doris 测试， 每个opt测试20轮取均值，搜索策略——random
![[Pasted image 20250409111626.png]]
**doris  考虑除O3之外的一些优化选项**
**问题与发现：**
在使用模型预测doris和redis的TOP-K优化配置中几乎完全重合。这里是TOP-10中有7-8个为相同的。这些优化配置在redis上表现较好，但是在doris中表现并不好。

doris的热点函数集中在`bucket_find`函数，**超过一半**的执行时间是这个函数。在投票的时候这个函数有“一票否决权”，如果对他预测不准确可能整个项目的预测就不准确。
![[Pasted image 20250409161923.png]]
![[bucket_find.png]]

**投票： 聚合的时候采用不同的聚合的策略得到不同的起点**

**目前认为的原因：**
1. train 2100条 中的所有OPT都并不如O3，因为在测试的时候最优的结果是是O3
2. 模型的预测功能有问题，找不到最优的优化配置。

### 下一步的计划：
0. 先看一下SCANN的效果
1. 使用SRTuner/random测试，看一下效果。（之前在lab的服务器上测试doris50轮是0.98 但是误差较大，不排除是误差的问题）
2. 现在的OPT来自train set，但是train set的opt是有限的。

先预测得到TOP-K，再从TOP-K中变异得到opts，再对opts进行预测，得到新的TOP-K

topk -》 110110  