# 项目简介

本项目基于预训练代码模型CodeT5提出了一种融合“源代码+优化配置”的应用级语义表征方法，用于实现高效、准确的性能预测和编译器自动调优功能。

## 主要文件

本项目主要文件如下，其中每一个文件夹都是一个小的模块。本系统共分为三个大模块：预处理模块、（模型微调与）预测模块、搜索模块。其中预处理模块可以细分为函数信息提取、热点函数提取、编译约束提取等工具。

```bash
Autotunning  
├── models                  模型微调与预测模块  
├── prepare                 预处理模块  
│  ├── get_hotfunction      负责提取项目中的热点函数  
│  ├── get_projrect_info    负责提取项目中所有函数的信息  
│  └── reduce_constrains    负责提取项目的编译约束（如禁止开启的选项、不可共现的选项等）  
├── README.md             README文件  
├── search                编译选项调优模块  
└── transformer.yml       Conda 环境配置文件

```

# 模块简介

![时序图](file:///C:/Users/hongqiwang/Desktop/Autotunning-s2/%E6%97%B6%E5%BA%8F%E5%9B%BE.png?lastModify=1755677210)

1. 函数信息提取： **目前使用的是`clanglibtooling`,通过遍历AST的方式**，匹配函数定义节点（FunctionDecl），并抽取对应节点的函数名，行号，返回值等信息。 目前有两个问题需要解决——一是**迁移到gcc上**；二是目前了解到的方法都需要进行编译，而编译又因为使用不同的构建工具，导致这一步无法集成在整个**自动化脚本中**。
    
2. 热点函数提取：利用的是`gperftools`工具，对项目进行实际的测试，得到热点函数.
    
3. 约束求解： 简单来讲是利用二分法找到项目约束。
    
4. 注意：2-3步可以实现自动化，但是需要为每个项目实现一个Manager工具，该工具需要包含build、clean、test三个功能。
    
    class Manager(ABC):  
        """  
        Abstract base class for managing different projects.  
        """  
    ​  
        @abstractmethod  
        def build(self, flags):  
            """  
            Build the project with the given flags.  
            """  
            pass  
    ​  
        @abstractmethod  
        def clean(self):  
            """  
            Clean the project.  
            """  
            pass  
    ​  
        @abstractmethod  
        def test(self, enable_gperftools):  
            """  
            Test the project, return the performance.  
            """  
            pass