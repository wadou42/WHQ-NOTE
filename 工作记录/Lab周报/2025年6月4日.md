新数据集收集
搜索空间： **所有的01选项**
搜索程序：mysql、rocksdb、cbench以及**新增的faiss（与scann的功能基本一致）**

### 搜索遇到的问题与解决：
1. 约束问题，简单代码几乎没有约束，例如cbench几乎不需要约减。但是像faiss约束就很复杂。约束大致分为一下三个级别：
	* 编译不通过
	* 编译通过但是执行时间约是-O3的二十分倍
	* 编译通过但是执行时间是-O3的两倍以上

解决方法：利用约束求解的方法，把失败的条件依次定为编译不通过、执行时间非常长、执行时间长依次找到约束。

2. 项目级别优于-O3的比例太少了，例如第一次收集数据时rockddb200+轮没有一轮比-O3好，利用约束求解方法，可以把会导致执行时间过长的优化选项固定住，也就是找“约束”

**TODO**：在我们的最终方法中，这一步怎么确定？
是直接把常见的都会遇到的约束问题提取出来固定住，还是提供这种约减脚本？ 
但是最后肯定是约减之后再和SRTuner进行比较

### 搜索结果与数据收集结果：
截止到目前调优轮次与结果：
rocksdb：1.047
mysql： 1.33 （有很多类似超过10%的大波动，在之前的优化选项中这个加速比只有1.05）
faiss：1.07
cbench： 从0.9-1.2不等

从整个**项目级别**来讲, 优于-O3的比例：
cbench: 1423 / 7200
mysql :  48 / 107
rocksdb: 11 / 178
faiss :  6 / 68




从**函数级别**统计，优于-O3的比例（只考虑执行时间大于50ms的instance）
cBench：   6313 : 17727
faiss：       81     : 146
rocksdb： 3970 : 8579
mysql:       8698 : 9461
总计**5w条数据，约1.9w**条正instance

与之前的数据集对比（只查看执行时间大于50ms的instance）并且发现，只有负优化的cbench占比比较大
![[现在的数据加速比分布图.png|725]]  ![[之前的加速比对比图.png|750]]

去除加速比在1±0.1的，加速减速不明显的优化选项，结果如图，右边是之前的数据集
![[正样本的比例_margirn0_1.png | 300|450]]       ![[Pasted image 20250605081908.png | 300|450]]

### 下周TODO
按照之前的方法，利用新收集的数据集训练模型，测试